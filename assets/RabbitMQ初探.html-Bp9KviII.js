import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as a,b as n}from"./app-1sB8-tQp.js";const e="/assets/image-20240822194253214-CB2oGERW.png",l="/assets/image-20240822194306980-DmfbN3b8.png",t="/assets/image-20240822194347069-Crvs2rMK.png",p="/assets/image-20240822194617738-BrRm0D0C.png",h="/assets/image-20240822194554163-Zupz2SX9.png",r="/assets/image-20240822194710477-D0ghFzrk.png",k="/assets/image-20240822195257296-evLmmUmk.png",d="/assets/image-20240822195343554-105UVzkM.png",g="/assets/image-20240822200041108-DF-Z9OtE.png",o="/assets/image-20240822200323747-BALph7K0.png",c="/assets/image-20240822200609595-VAngBMNn.png",b="/assets/image-20240822201313557-BjSLCCdw.png",A="/assets/image-20240822203459531-CSZ5WSyC.png",m="/assets/image-20240822223145591-aK2aPc_6.png",u="/assets/image-20240822223328642-Bny8ArQp.png",B="/assets/image-20240822223530190-B3LlE0Q8.png",y="/assets/image-20211230172747783-UA0vh3zt.png",v="/assets/image-20240823165011838-4_BCvV_-.png",E="data:image/png;base64,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",F="/assets/image-20240823204208152-CvzJZWrk.png",C="/assets/image-20240823204549853-BJ3hSvfN.png",f="/assets/image-20240823204051854-D8_A4jO4.png",D="/assets/image-20240823204624130-B5izSR4z.png",M="/assets/image-20240823204121705-DG8xAu3n.png",q="/assets/image-20240823204827294-DzOsjfIL.png",Q="/assets/image-20240823205134476-CcqmGAgW.png",x="/assets/image-20240823205216896-hWs9ifOQ.png",R="/assets/image-20240823213311018-BC2WCUec.png",_="/assets/image-20240823211019184-DSpWxWHW.png",w={},j=n('<h1 id="rabbitmq" tabindex="-1"><a class="header-anchor" href="#rabbitmq"><span>RabbitMQ</span></a></h1><h2 id="参考链接" tabindex="-1"><a class="header-anchor" href="#参考链接"><span>参考链接</span></a></h2><p><a href="https://www.javabetter.cn/mq/rabbitmq-rumen.html" target="_blank" rel="noopener noreferrer">沉默王二</a></p><p><a href="https://juejin.cn/post/7071589818886520869#heading-17" target="_blank" rel="noopener noreferrer">稀土掘金-Jlo_</a></p><p><a href="https://janycode.github.io/categories/08-%E6%A1%86%E6%9E%B6%E6%8A%80%E6%9C%AF/07-RabbitMQ/" target="_blank" rel="noopener noreferrer">分类 - 07_RabbitMQ - 姜源の云笔记</a></p><p><a href="https://www.rabbitmq.com/tutorials" target="_blank" rel="noopener noreferrer">RabbitMQ Tutorials | RabbitMQ</a></p><p><a href="https://blog.csdn.net/qq_44760609/article/details/125084962" target="_blank" rel="noopener noreferrer">RabbitMQ六种工作模式详解_rabbitmq工作模式-CSDN博客</a></p><h2 id="amqp" tabindex="-1"><a class="header-anchor" href="#amqp"><span>AMQP</span></a></h2><p>信息传递链中，传递消息为上游，接收消息为下游</p><p>消息队列（Message Queue，MQ），队列，消息 先进先出</p><p>高级消息队列协议（Advanced Message Queue Protocol，AMQP）</p><ul><li>一种开放的消息中间件协议，用于在分布式系统之间进行消息的发送和接收。它定义了消息的格式、路由和传输机制，旨在实现不同系统之间的互操作性（Answer by ChatGPT）</li><li>RabbitMQ 是一个基于 AMQP 的消息代理（消息中间件），它实现了 AMQP 协议，并提供了一系列相应的功能和特性（Answer by ChatGPT）</li><li><a href="https://www.rabbitmq.com/tutorials/amqp-concepts#highlevel-overview" target="_blank" rel="noopener noreferrer">AMQP 0-9-1 Model Explained | RabbitMQ ~ AMQP 0-9-1 模型解释 | RabbitMQ</a></li></ul><h2 id="mq的作用" tabindex="-1"><a class="header-anchor" href="#mq的作用"><span>MQ的作用</span></a></h2><p>[MQ作用的详细解释——04-RabbitMQ 高级教程 - 姜源の云笔记 (janycode.github.io)](https://janycode.github.io/2021/08/17/08_框架技术/07_RabbitMQ/04-RabbitMQ 高级教程/index.html#1-2-为什么要用-MQ)</p><p>流量削峰</p><p>应用解耦</p><p>异步处理</p><p>广播</p><h2 id="mq的分类" tabindex="-1"><a class="header-anchor" href="#mq的分类"><span>MQ的分类</span></a></h2><p><a href="https://janycode.github.io/2021/08/17/08_%E6%A1%86%E6%9E%B6%E6%8A%80%E6%9C%AF/07_RabbitMQ/04-RabbitMQ%20%E9%AB%98%E7%BA%A7%E6%95%99%E7%A8%8B/index.html#1-3-MQ-%E7%9A%84%E5%88%86%E7%B1%BB" target="_blank" rel="noopener noreferrer">MQ的分类详讲 - 04-RabbitMQ 高级教程 - 姜源の云笔记</a></p><p>ActiveMQ</p><p>Kafka</p><p>RocketMQ</p><p>RabbitMQ</p><h2 id="rabbitmq-1" tabindex="-1"><a class="header-anchor" href="#rabbitmq-1"><span>RabbitMQ</span></a></h2><h3 id="rabbitmq安装" tabindex="-1"><a class="header-anchor" href="#rabbitmq安装"><span>RabbitMQ安装</span></a></h3><p><s>Erlang安装</s>(用Chocolatey安装RabbitMQ可直接跳过Erlang安装RabbitMQ)</p><p><a href="https://erlang.org/download/otp_versions_tree.html" target="_blank" rel="noopener noreferrer">https://erlang.org/download/otp_versions_tree.html</a></p><img src="'+e+'" alt="image-20240822194253214" style="zoom:50%;"><img src="'+l+'" alt="image-20240822194306980" style="zoom:50%;"><img src="'+t+'" alt="image-20240822194347069" style="zoom:50%;"><img src="'+p+'" alt="image-20240822194617738" style="zoom:50%;"><p>貌似也能用过Chocolatey</p><img src="'+h+'" alt="image-20240822194554163" style="zoom:33%;"><p>安装Rabbit MQ</p><p><a href="https://www.rabbitmq.com/install-windows.html" target="_blank" rel="noopener noreferrer">https://www.rabbitmq.com/install-windows.html</a></p><img src="'+r+'" alt="image-20240822194710477" style="zoom:50%;"><p>使用Chocolatey安装</p><figure><img src="'+k+'" alt="image-20240822195257296" tabindex="0" loading="lazy"><figcaption>image-20240822195257296</figcaption></figure><figure><img src="'+d+'" alt="image-20240822195343554" tabindex="0" loading="lazy"><figcaption>image-20240822195343554</figcaption></figure><p>貌似Erlang又装了一遍...</p><p>删除原先的Erlang</p><img src="'+g+'" alt="image-20240822200041108" style="zoom:67%;"><p>打开 RabbitMQ Command Prompt (sbin dir) 输入 rabbitmqctl.bat status 来确认 RabbitMQ 的启动状态</p><p>报错了...</p><img src="'+o+'" alt="image-20240822200323747" style="zoom:80%;"><p>环境变量出问题了，指向原先卸载的路径</p><figure><img src="'+c+'" alt="image-20240822200609595" tabindex="0" loading="lazy"><figcaption>image-20240822200609595</figcaption></figure><p>修改环境路径</p><img src="'+b+`" alt="image-20240822201313557" style="zoom:70%;"><p>还是报错</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>C:\\Program Files\\RabbitMQ Server\\rabbitmq_server-3.13.6\\sbin&gt;rabbitmqctl.bat status</span></span>
<span class="line"><span>Error: unable to perform an operation on node &#39;rabbit@DESKTOP-42B4J2H&#39;. Please see diagnostics information and suggestions below.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Most common reasons for this are:</span></span>
<span class="line"><span></span></span>
<span class="line"><span> * Target node is unreachable (e.g. due to hostname resolution, TCP connection or firewall issues)</span></span>
<span class="line"><span> * CLI tool fails to authenticate with the server (e.g. due to CLI tool&#39;s Erlang cookie not matching that of the server)</span></span>
<span class="line"><span> * Target node is not running</span></span>
<span class="line"><span></span></span>
<span class="line"><span>In addition to the diagnostics info below:</span></span>
<span class="line"><span></span></span>
<span class="line"><span> * See the CLI, clustering and networking guides on https://rabbitmq.com/documentation.html to learn more</span></span>
<span class="line"><span> * Consult server logs on node rabbit@DESKTOP-42B4J2H</span></span>
<span class="line"><span> * If target node is configured to use long node names, don&#39;t forget to use --longnames with CLI tools</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DIAGNOSTICS</span></span>
<span class="line"><span>===========</span></span>
<span class="line"><span></span></span>
<span class="line"><span>attempted to contact: [&#39;rabbit@DESKTOP-42B4J2H&#39;]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>rabbit@DESKTOP-42B4J2H:</span></span>
<span class="line"><span>  * connected to epmd (port 4369) on DESKTOP-42B4J2H</span></span>
<span class="line"><span>  * epmd reports: node &#39;rabbit&#39; not running at all</span></span>
<span class="line"><span>                  no other nodes on DESKTOP-42B4J2H</span></span>
<span class="line"><span>  * suggestion: start the node</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Current node details:</span></span>
<span class="line"><span> * node name: &#39;rabbitmqcli-20-rabbit@DESKTOP-42B4J2H&#39;</span></span>
<span class="line"><span> * effective user&#39;s home directory: c:/Users/WIN11</span></span>
<span class="line"><span> * Erlang cookie hash: rzge9A98Fk+Pr2fBfdq6CQ==</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 choco uninstall rabbitmq 以及 choco uninstall erlang，重新安装一遍</p><p>成功了，显示PID等信息了</p><img src="`+A+'" alt="image-20240822203459531" style="zoom:67%;"><p>启用客户端管理的UI插件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>rabbitmq-plugins enable rabbitmq_management</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>访问地址<a href="http://localhost:15672" target="_blank" rel="noopener noreferrer">http://localhost:15672</a></p><h3 id="rabbitmq简单配置" tabindex="-1"><a class="header-anchor" href="#rabbitmq简单配置"><span>RabbitMQ简单配置</span></a></h3><p>默认用户名 / 密码：guest</p><p>新建一个VirtualHosts</p><figure><img src="'+m+'" alt="image-20240822223145591" tabindex="0" loading="lazy"><figcaption>image-20240822223145591</figcaption></figure><p>新建一个User</p><figure><img src="'+u+'" alt="image-20240822223328642" tabindex="0" loading="lazy"><figcaption>image-20240822223328642</figcaption></figure><p>设置User在 VirtualHosts ：/admin 的权限</p><figure><img src="'+B+'" alt="image-20240822223530190" tabindex="0" loading="lazy"><figcaption>image-20240822223530190</figcaption></figure><p><a href="https://juejin.cn/post/7071589818886520869#heading-19" target="_blank" rel="noopener noreferrer">用户配置 及 虚拟主机 说明</a></p><h3 id="核心概念" tabindex="-1"><a class="header-anchor" href="#核心概念"><span>核心概念</span></a></h3><p>[核心概念的解释——04-RabbitMQ 高级教程 - 姜源の云笔记 (janycode.github.io)](https://janycode.github.io/2021/08/17/08_框架技术/07_RabbitMQ/04-RabbitMQ 高级教程/index.html#2-2-四大核心概念)</p><p>生产者 （Producer）：生产消息</p><p>交换机（Exchange）：转发消息，本身并不存储消息</p><p>队列（Queue）：消息缓冲区</p><p>消费者（Consumer）：消费消息</p><p>Broker</p><p>Connection：producer / cosumer 与 broker 之间的 TCP 连接</p><p>Channel：在connection内部建立的逻辑连接</p><p>Binding：exchange和queue之间的虚拟连接</p><figure><img src="'+y+'" alt="image-20211230172747783" tabindex="0" loading="lazy"><figcaption>image-20211230172747783</figcaption></figure><h3 id="amqp模型" tabindex="-1"><a class="header-anchor" href="#amqp模型"><span>AMQP模型</span></a></h3><p><a href="https://www.rabbitmq.com/tutorials/amqp-concepts#amqp-model" target="_blank" rel="noopener noreferrer">AMQP 0-9-1 Model Explained | RabbitMQ</a></p><blockquote><p>The AMQP 0-9-1 Model has the following view of the world: messages are published to <em>exchanges</em>, which are often compared to post offices or mailboxes. Exchanges then distribute message copies to <em>queues</em> using rules called <em>bindings</em>. Then the broker either deliver messages to consumers subscribed to queues, or consumers fetch/pull messages from queues on demand.</p><p>AMQP 0-9-1 模型具有以下世界观：消息发布到交换器，交换器通常与邮局或邮箱进行比较。然后，交换器使用称为绑定的规则将消息副本分发到队列。然后，代理要么将消息传递给订阅队列的消费者，要么消费者按需从队列中获取/拉取消息。</p></blockquote><h4 id="exchange类型" tabindex="-1"><a class="header-anchor" href="#exchange类型"><span>Exchange类型</span></a></h4><p><a href="https://www.rabbitmq.com/tutorials/amqp-concepts#exchanges" target="_blank" rel="noopener noreferrer">AMQP 0-9-1 Model Explained | RabbitMQ ~ AMQP 0-9-1 模型解释 | RabbitMQ</a></p><ul><li><p>Direct</p></li><li><p>Fanout</p></li><li><p>Topic</p></li><li><p>Headers（用得少）</p><ul><li><a href="https://blog.csdn.net/hry2015/article/details/79188615" target="_blank" rel="noopener noreferrer">中间件系列七 RabbitMQ之header exchange(头交换机)用法-CSDN博客</a></li></ul></li></ul><h4 id="queues" tabindex="-1"><a class="header-anchor" href="#queues"><span>Queues</span></a></h4><p><a href="https://www.rabbitmq.com/tutorials/amqp-concepts#queues" target="_blank" rel="noopener noreferrer">AMQP 0-9-1 Model Explained | RabbitMQ ~ AMQP 0-9-1 模型解释 | RabbitMQ</a></p><ul><li>Name</li><li>Durable</li></ul><h4 id="bindings" tabindex="-1"><a class="header-anchor" href="#bindings"><span>Bindings</span></a></h4><p><a href="https://www.rabbitmq.com/tutorials/amqp-concepts#bindings" target="_blank" rel="noopener noreferrer">AMQP 0-9-1 Model Explained | RabbitMQ ~ AMQP 0-9-1 模型解释 | RabbitMQ</a></p><p>Bindings are rules that exchanges use (among other things) to route messages to queues.</p><ul><li>Queue</li><li>Exchange</li></ul><h4 id="consumer" tabindex="-1"><a class="header-anchor" href="#consumer"><span>Consumer</span></a></h4><p><a href="https://www.rabbitmq.com/tutorials/amqp-concepts#consumers" target="_blank" rel="noopener noreferrer">AMQP 0-9-1 Model Explained | RabbitMQ ~ AMQP 0-9-1 模型解释 | RabbitMQ</a></p><ul><li>Message Acknowledgements</li><li>Rejecting Message</li><li>Negative Message</li><li>Prefetching Message</li></ul><h3 id="rabbitmq-工作模式" tabindex="-1"><a class="header-anchor" href="#rabbitmq-工作模式"><span>RabbitMQ 工作模式</span></a></h3><p><a href="https://www.rabbitmq.com/tutorials#queue-tutorials" target="_blank" rel="noopener noreferrer">RabbitMQ Tutorials | RabbitMQ - 有配图有讲解</a></p><h4 id="_1-简单模式" tabindex="-1"><a class="header-anchor" href="#_1-简单模式"><span>1.简单模式</span></a></h4><p>一个生产者，一个消费者</p><h4 id="_2-工作队列模式" tabindex="-1"><a class="header-anchor" href="#_2-工作队列模式"><span>2.工作队列模式</span></a></h4><p>一个生产者，多个消费者</p><p>公平分发、不公平分发、Qos：<a href="https://blog.csdn.net/qq_44760609/article/details/125084962" target="_blank" rel="noopener noreferrer">RabbitMQ六种工作模式详解_rabbitmq工作模式-CSDN博客</a></p><h4 id="_3-发布订阅模式" tabindex="-1"><a class="header-anchor" href="#_3-发布订阅模式"><span>3.发布订阅模式</span></a></h4><p>Exchange type：FANOUT</p><p>将消息广播发送给每个队列</p><h4 id="_4-路由模式" tabindex="-1"><a class="header-anchor" href="#_4-路由模式"><span>4.路由模式</span></a></h4><p>Exchange type：DIRECT(定向)</p><p>比较 消息中的 Routing key 与 Binding 中的 Routing key，相等则发送到 Binding对应的Queue</p><h4 id="_5-主题模式" tabindex="-1"><a class="header-anchor" href="#_5-主题模式"><span>5.主题模式</span></a></h4><p>Exchange type：TOPIC</p><p>A few valid routing key examples: &quot;<code>stock.usd.nyse</code>&quot;, &quot;<code>nyse.vmw</code>&quot;, &quot;<code>quick.orange.rabbit</code>&quot;.</p><blockquote><p><a href="https://www.rabbitmq.com/tutorials/tutorial-five-java" target="_blank" rel="noopener noreferrer">RabbitMQ tutorial - Topics | RabbitMQ</a></p></blockquote><p>通配符，<code>*</code> 代表一个单词，<code>#</code>代表零或多个单词</p><h4 id="_6-rpc模式" tabindex="-1"><a class="header-anchor" href="#_6-rpc模式"><span>6.RPC模式</span></a></h4><p>远程过程调用（Remote Procedure Call，RPC）</p><p><a href="https://www.rabbitmq.com/tutorials/tutorial-six-java" target="_blank" rel="noopener noreferrer">RabbitMQ tutorial - Remote procedure call (RPC) | RabbitMQ</a></p><h3 id="消息分发" tabindex="-1"><a class="header-anchor" href="#消息分发"><span>消息分发</span></a></h3><p><a href="https://janycode.github.io/2021/08/17/08_%E6%A1%86%E6%9E%B6%E6%8A%80%E6%9C%AF/07_RabbitMQ/04-RabbitMQ%20%E9%AB%98%E7%BA%A7%E6%95%99%E7%A8%8B/index.html#2-6-%E6%B6%88%E6%81%AF%E5%88%86%E5%8F%91" target="_blank" rel="noopener noreferrer">04-RabbitMQ 高级教程 - 姜源の云笔记</a></p><ul><li><p>轮询分发</p></li><li><p>不公平分发</p><ul><li>channel.basicQos(n);</li></ul></li><li><p>限流</p></li></ul><h3 id="消息确认" tabindex="-1"><a class="header-anchor" href="#消息确认"><span>消息确认</span></a></h3><p><a href="https://janycode.github.io/2021/08/17/08_%E6%A1%86%E6%9E%B6%E6%8A%80%E6%9C%AF/07_RabbitMQ/04-RabbitMQ%20%E9%AB%98%E7%BA%A7%E6%95%99%E7%A8%8B/index.html#2-7-%E6%B6%88%E6%81%AF%E7%A1%AE%E8%AE%A4" target="_blank" rel="noopener noreferrer">04-RabbitMQ 高级教程 - 姜源の云笔记</a></p><ul><li>发布确认（生产者——交换机）</li><li>消息应答（消费者） <ul><li>channel.basicAck()</li><li>channel.basicNack()</li><li>channel.basicReject()</li></ul></li></ul><h3 id="持久化" tabindex="-1"><a class="header-anchor" href="#持久化"><span>持久化</span></a></h3><p><a href="https://janycode.github.io/2021/08/17/08_%E6%A1%86%E6%9E%B6%E6%8A%80%E6%9C%AF/07_RabbitMQ/04-RabbitMQ%20%E9%AB%98%E7%BA%A7%E6%95%99%E7%A8%8B/index.html#2-8-%E6%8C%81%E4%B9%85%E5%8C%96" target="_blank" rel="noopener noreferrer">04-RabbitMQ 高级教程 - 姜源の云笔记</a></p><ul><li>队列持久化</li><li>消息持久化</li></ul><h3 id="队列" tabindex="-1"><a class="header-anchor" href="#队列"><span>队列</span></a></h3><p><a href="https://janycode.github.io/2021/08/17/08_%E6%A1%86%E6%9E%B6%E6%8A%80%E6%9C%AF/07_RabbitMQ/04-RabbitMQ%20%E9%AB%98%E7%BA%A7%E6%95%99%E7%A8%8B/index.html#2-9-%E9%98%9F%E5%88%97" target="_blank" rel="noopener noreferrer">04-RabbitMQ 高级教程 - 姜源の云笔记</a></p><ul><li>死信队列 <ul><li>由于某些原因导致队列中的消息无法被消费（例如 消息的 TTL 过期、队列已满、消息被拒绝）</li><li>正常队列 与 死信队列 的绑定</li></ul></li><li>延迟队列 <ul><li>队列 TTL / 消息 TTL + 死信队列</li></ul></li><li>优先队列 <ul><li>队列 / 消息 优先级设置</li></ul></li><li>惰性队列 <ul><li>尽可能将消息持久化到磁盘，消费者消费时才加载到内存</li></ul></li></ul><h3 id="ttl——最大存活时间" tabindex="-1"><a class="header-anchor" href="#ttl——最大存活时间"><span>TTL——最大存活时间</span></a></h3><p><a href="https://janycode.github.io/2021/08/17/08_%E6%A1%86%E6%9E%B6%E6%8A%80%E6%9C%AF/07_RabbitMQ/04-RabbitMQ%20%E9%AB%98%E7%BA%A7%E6%95%99%E7%A8%8B/index.html#2-10-TTL" target="_blank" rel="noopener noreferrer">04-RabbitMQ 高级教程 - 姜源の云笔记</a></p><ul><li>队列 TTL</li><li>消息 TTL</li></ul><h3 id="幂等性" tabindex="-1"><a class="header-anchor" href="#幂等性"><span>幂等性</span></a></h3><p><a href="https://janycode.github.io/2021/08/17/08_%E6%A1%86%E6%9E%B6%E6%8A%80%E6%9C%AF/07_RabbitMQ/04-RabbitMQ%20%E9%AB%98%E7%BA%A7%E6%95%99%E7%A8%8B/index.html#2-11-%E5%B9%82%E7%AD%89%E6%80%A7" target="_blank" rel="noopener noreferrer">04-RabbitMQ 高级教程 - 姜源の云笔记</a></p><ul><li>消费 可能存在 重复消费 问题</li><li>幂等性保障</li></ul><h2 id="springboot整合rabbit-mq" tabindex="-1"><a class="header-anchor" href="#springboot整合rabbit-mq"><span>SpringBoot整合Rabbit MQ</span></a></h2><h3 id="参考链接-1" tabindex="-1"><a class="header-anchor" href="#参考链接-1"><span>参考链接</span></a></h3><p><a href="https://netfilx.github.io/spring-boot/8.springboot-rabbitmq/springboot-rabbitmq" target="_blank" rel="noopener noreferrer">Spring Boot 整合RabbitMQ (netfilx.github.io)</a></p><p><a href="https://blog.csdn.net/qq_35387940/article/details/100514134" target="_blank" rel="noopener noreferrer">Springboot 整合RabbitMq ，用心看完这一篇就够了_springboot rabbitmq-CSDN博客</a></p><p>新建一个SpringBoot工程</p><figure><img src="'+v+`" alt="image-20240823165011838" tabindex="0" loading="lazy"><figcaption>image-20240823165011838</figcaption></figure><h3 id="引入依赖" tabindex="-1"><a class="header-anchor" href="#引入依赖"><span>引入依赖</span></a></h3><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-amqp --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;org.springframework.boot&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;spring-boot-starter-amqp&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;3.3.2&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>记得Load maven changes</p><figure><img src="`+E+`" alt="image-20240823165833210" tabindex="0" loading="lazy"><figcaption>image-20240823165833210</figcaption></figure><h3 id="配置文件application-properties" tabindex="-1"><a class="header-anchor" href="#配置文件application-properties"><span>配置文件application.properties</span></a></h3><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#rabbitmq</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">spring.rabbitmq.host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># virtual host</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">spring.rabbitmq.virtual-host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">/admin</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">spring.rabbitmq.port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">5672</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">spring.rabbitmq.username</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">admin</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">spring.rabbitmq.password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">admin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="rabbitconfig" tabindex="-1"><a class="header-anchor" href="#rabbitconfig"><span>RabbitConfig</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">package</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> com.cz.demo.config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.amqp.core.Binding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.amqp.core.BindingBuilder</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.amqp.core.DirectExchange</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.amqp.core.Queue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.context.annotation.Bean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.context.annotation.Configuration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Configuration</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> RabbitConfig</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    //队列</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Queue</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> queue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Queue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;queue&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="生产者" tabindex="-1"><a class="header-anchor" href="#生产者"><span>生产者</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">package</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> com.cz.demo.mq</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> lombok.extern.slf4j.Slf4j</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.amqp.rabbit.core.RabbitTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.beans.factory.annotation.Autowired</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.stereotype.Component</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Slf4j</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Component</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Producer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> RabbitTemplate</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> rabbitTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> sendMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Hello RabbitMQ&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;发送消息: {}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, message);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            //注：这里少指定了routing key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            //正确语句：rabbitTemplate.convertAndSend(&quot;queue&quot;, message);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            rabbitTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">convertAndSend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(message);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Exception</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">            log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;send message error: {}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="消费者" tabindex="-1"><a class="header-anchor" href="#消费者"><span>消费者</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">package</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> com.cz.demo.mq</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> lombok.extern.slf4j.Slf4j</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.amqp.rabbit.annotation.RabbitHandler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.amqp.rabbit.annotation.RabbitListener</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.stereotype.Component</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Component</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">RabbitListener</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">queues</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;queue&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Slf4j</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Consumer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">RabbitHandler</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> receive</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">){</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;接收到消息: {}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, message);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="测试" tabindex="-1"><a class="header-anchor" href="#测试"><span>测试</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">package</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> com.cz.demo.test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> com.cz.demo.mq.Producer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.junit.jupiter.api.Test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.beans.factory.annotation.Autowired</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springframework.boot.test.context.SpringBootTest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">SpringBootTest</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> RabbitmqTest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Autowired</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Producer</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> producer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Test</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> send</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        producer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sendMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>开始Debug</p><figure><img src="`+F+'" alt="image-20240823204208152" tabindex="0" loading="lazy"><figcaption>image-20240823204208152</figcaption></figure><p>发送消息后，打开<a href="http://localhost:15672" target="_blank" rel="noopener noreferrer">RabbitMQ Management</a></p><blockquote><p>受到 <a href="https://blog.csdn.net/qq_35387940/article/details/100514134" target="_blank" rel="noopener noreferrer">Springboot 整合RabbitMq ，用心看完这一篇就够了_springboot rabbitmq-CSDN博客</a> 博客的启发，想到了可以运用 Debug + RabbitMQ Management 来查看队列中的消息</p></blockquote><figure><img src="'+C+'" alt="image-20240823204549853" tabindex="0" loading="lazy"><figcaption>image-20240823204549853</figcaption></figure><p>切换到默认的 Exchange（AMQP default）</p><figure><img src="'+f+'" alt="image-20240823204051854" tabindex="0" loading="lazy"><figcaption>image-20240823204051854</figcaption></figure><p>切换到Queue界面</p><figure><img src="'+D+'" alt="image-20240823204624130" tabindex="0" loading="lazy"><figcaption>image-20240823204624130</figcaption></figure><p>进入queue，并没有看到队列中有消息</p><figure><img src="'+M+'" alt="image-20240823204121705" tabindex="0" loading="lazy"><figcaption>image-20240823204121705</figcaption></figure><p>运行后，控制台并没有消费者输出的消息</p><h3 id="问题" tabindex="-1"><a class="header-anchor" href="#问题"><span>问题</span></a></h3><p>Exchange 和 queue 貌似没有匹配上？</p><p>进入 Exchange: (AMQP default) in virtual host /admin 中看到 Binding</p><figure><img src="'+q+`" alt="image-20240823204827294" tabindex="0" loading="lazy"><figcaption>image-20240823204827294</figcaption></figure><p>修改Producer.java，convertAndSend中加上routingKey</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> sendMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> message </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Hello RabbitMQ&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;发送消息: {}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, message);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    try</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        rabbitTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">convertAndSend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;queue&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, message);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Exception</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;send message error: {}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新测试，并在sendMessage() 中打断点</p><p>一样在发送消息后，消费者 消费 消息之前，回到 <a href="http://localhost:15672" target="_blank" rel="noopener noreferrer">RabbitMQ Management</a> 查看Exchange</p><figure><img src="`+Q+'" alt="image-20240823205134476" tabindex="0" loading="lazy"><figcaption>image-20240823205134476</figcaption></figure><p>然后，查看Queue中的queue，收到消息了</p><figure><img src="'+x+'" alt="image-20240823205216896" tabindex="0" loading="lazy"><figcaption>image-20240823205216896</figcaption></figure><p>但是，控制台没有收到消息，可能跟 Debug 停留太久有关（纯猜测），重新运行，先消费之前在队列的消息，然后，接着消费此次运行生产的消息</p><h3 id="问题所在" tabindex="-1"><a class="header-anchor" href="#问题所在"><span>问题所在</span></a></h3><p>没有在RabbitConfig中指定Exchange时，采用默认的（AMOP default）Exchange，而默认的Exchange Type是Direct，routing key 默认为 Queue 名</p><img src="'+R+'" alt="image-20240823213311018" style="zoom:50%;"><figure><img src="'+_+`" alt="image-20240823211019184" tabindex="0" loading="lazy"><figcaption>image-20240823211019184</figcaption></figure><h3 id="尝试指定exchange和routing-key" tabindex="-1"><a class="header-anchor" href="#尝试指定exchange和routing-key"><span>尝试指定Exchange和routing key</span></a></h3><p>RabbitConfig.java</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">	//队列</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Queue</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> queue</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Queue</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;testQueue3&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    //交换机，路由模式</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Bean</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    DirectExchange</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> testDirectExchange</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> DirectExchange</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;testDirectExchange2&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    //Binding，绑定队列和交换机</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Bean</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    Binding</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> bindingDirect</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> BindingBuilder</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">queue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">to</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">testDirectExchange</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;testRoutingKey&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Producer.java</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> send</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> message </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Hello RabbitMQ&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;send message: {}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, message);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    try</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        rabbitTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">convertAndSend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;testDirectExchange2&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;testRoutingKey&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, message);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Exception</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;send message error: {}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Consumer.java</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Component</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">RabbitListener</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">queues</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;testQueue3&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Slf4j</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Consumer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">RabbitHandler</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> receive</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">){</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;接收到消息: {}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, message);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>RabbitTest.java</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Test</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> send2</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    producer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,190),T=[j];function z(S,P){return a(),s("div",null,T)}const I=i(w,[["render",z],["__file","RabbitMQ初探.html.vue"]]),Z=JSON.parse('{"path":"/middleware/message_queue/RabbitMQ%E5%88%9D%E6%8E%A2.html","title":"RabbitMQ初探","lang":"zh-CN","frontmatter":{"title":"RabbitMQ初探","category":["MessageQueue"],"description":"RabbitMQ 参考链接 沉默王二 稀土掘金-Jlo_ 分类 - 07_RabbitMQ - 姜源の云笔记 RabbitMQ Tutorials | RabbitMQ RabbitMQ六种工作模式详解_rabbitmq工作模式-CSDN博客 AMQP 信息传递链中，传递消息为上游，接收消息为下游 消息队列（Message Queue，MQ），队列，消...","head":[["meta",{"property":"og:url","content":"https://raylan-chen.github.io/middleware/message_queue/RabbitMQ%E5%88%9D%E6%8E%A2.html"}],["meta",{"property":"og:site_name","content":"MyBlog"}],["meta",{"property":"og:title","content":"RabbitMQ初探"}],["meta",{"property":"og:description","content":"RabbitMQ 参考链接 沉默王二 稀土掘金-Jlo_ 分类 - 07_RabbitMQ - 姜源の云笔记 RabbitMQ Tutorials | RabbitMQ RabbitMQ六种工作模式详解_rabbitmq工作模式-CSDN博客 AMQP 信息传递链中，传递消息为上游，接收消息为下游 消息队列（Message Queue，MQ），队列，消..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-10T07:07:17.000Z"}],["meta",{"property":"article:author","content":"raylan.chen"}],["meta",{"property":"article:modified_time","content":"2024-11-10T07:07:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"RabbitMQ初探\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-11-10T07:07:17.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"raylan.chen\\",\\"url\\":\\"\\"}]}"]]},"headers":[{"level":2,"title":"参考链接","slug":"参考链接","link":"#参考链接","children":[]},{"level":2,"title":"AMQP","slug":"amqp","link":"#amqp","children":[]},{"level":2,"title":"MQ的作用","slug":"mq的作用","link":"#mq的作用","children":[]},{"level":2,"title":"MQ的分类","slug":"mq的分类","link":"#mq的分类","children":[]},{"level":2,"title":"RabbitMQ","slug":"rabbitmq-1","link":"#rabbitmq-1","children":[{"level":3,"title":"RabbitMQ安装","slug":"rabbitmq安装","link":"#rabbitmq安装","children":[]},{"level":3,"title":"RabbitMQ简单配置","slug":"rabbitmq简单配置","link":"#rabbitmq简单配置","children":[]},{"level":3,"title":"核心概念","slug":"核心概念","link":"#核心概念","children":[]},{"level":3,"title":"AMQP模型","slug":"amqp模型","link":"#amqp模型","children":[]},{"level":3,"title":"RabbitMQ 工作模式","slug":"rabbitmq-工作模式","link":"#rabbitmq-工作模式","children":[]},{"level":3,"title":"消息分发","slug":"消息分发","link":"#消息分发","children":[]},{"level":3,"title":"消息确认","slug":"消息确认","link":"#消息确认","children":[]},{"level":3,"title":"持久化","slug":"持久化","link":"#持久化","children":[]},{"level":3,"title":"队列","slug":"队列","link":"#队列","children":[]},{"level":3,"title":"TTL——最大存活时间","slug":"ttl——最大存活时间","link":"#ttl——最大存活时间","children":[]},{"level":3,"title":"幂等性","slug":"幂等性","link":"#幂等性","children":[]}]},{"level":2,"title":"SpringBoot整合Rabbit MQ","slug":"springboot整合rabbit-mq","link":"#springboot整合rabbit-mq","children":[{"level":3,"title":"参考链接","slug":"参考链接-1","link":"#参考链接-1","children":[]},{"level":3,"title":"引入依赖","slug":"引入依赖","link":"#引入依赖","children":[]},{"level":3,"title":"配置文件application.properties","slug":"配置文件application-properties","link":"#配置文件application-properties","children":[]},{"level":3,"title":"RabbitConfig","slug":"rabbitconfig","link":"#rabbitconfig","children":[]},{"level":3,"title":"生产者","slug":"生产者","link":"#生产者","children":[]},{"level":3,"title":"消费者","slug":"消费者","link":"#消费者","children":[]},{"level":3,"title":"测试","slug":"测试","link":"#测试","children":[]},{"level":3,"title":"问题","slug":"问题","link":"#问题","children":[]},{"level":3,"title":"问题所在","slug":"问题所在","link":"#问题所在","children":[]},{"level":3,"title":"尝试指定Exchange和routing key","slug":"尝试指定exchange和routing-key","link":"#尝试指定exchange和routing-key","children":[]}]}],"git":{"createdTime":1726727459000,"updatedTime":1731222437000,"contributors":[{"name":"Raylan.Chen","email":"chen.z.my@qq.com","commits":1}]},"readingTime":{"minutes":9.46,"words":2838},"filePathRelative":"middleware/message_queue/RabbitMQ初探.md","localizedDate":"2024年9月19日","excerpt":"\\n<h2>参考链接</h2>\\n<p><a href=\\"https://www.javabetter.cn/mq/rabbitmq-rumen.html\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">沉默王二</a></p>\\n<p><a href=\\"https://juejin.cn/post/7071589818886520869#heading-17\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">稀土掘金-Jlo_</a></p>\\n<p><a href=\\"https://janycode.github.io/categories/08-%E6%A1%86%E6%9E%B6%E6%8A%80%E6%9C%AF/07-RabbitMQ/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">分类 - 07_RabbitMQ - 姜源の云笔记</a></p>","autoDesc":true}');export{I as comp,Z as data};
